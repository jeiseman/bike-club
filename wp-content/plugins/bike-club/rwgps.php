<?php
function bk_rwgps_expired_func()
{
$param = array(
// 'fields' => 'display_name',
/// 'meta_query' => array( 'key' => 'status', 'value' => 'active', 'meta_compare' => 'LIKE' ),
'include' => array(
3124,
5558,
3166,
3708,
5708,
5687,
2900,
3927,
5524,
3687,
2882,
5691,
5700,
5702,
5698,
4079,
3719,
4406,
3334,
5270,
5539,
3790,
5319,
4677,
4395,
4999,
5615,
5663,
4565,
5010,
4657,
3195,
4871,
3152,
4833,
5662,
3582,
5243,
5672,
5669,
5156,
4413,
5669,
2907,
4849,
3680,
5339,
4504,
5473,
5060,
4588,
4800,
3374,
5565,
5630,
5528,
5646,
5595,
5653,
4993,
5289,
5065,
4236,
5106,
3275,
5581,
4927,
4520,
4670,
4693,
4098,
4897,
4489,
5628,
3548,
4175,
5620,
5598,
4479,
5472,
4499,
3168,
4384,
4186,
4736,
4767,
2956,
3728,
5311,
5578,
5377,
4246,
3081,
5436,
3501,
3242,
5011,
2898,
5563,
4469,
5368,
5552,
4747,
2939,
5549,
3410,
3058,
3128,
3086,
5497,
5347,
5447,
3070,
3154,
4941,
3605,
3449,
5213,
3478,
4765,
4174,
5181,
4145,
4912,
5148,
4243,
3825,
4620,
3163,
3240,
3813,
4855,
5252,
3315,
4020,
5304,
4950,
2896,
5275,
3675,
2959,
4501,
3725,
2897,
3254,
5177,
5134,
5128,
4870,
4886,
5004,
4780,
4993,
2933,
2969,
2968,
3164,
3198,
3316,
2937,
4242,
3405,
3097,
4993,
4902,
4750,
4880,
3971,
4973,
3072,
4061,
3580,
4358,
4169,
3964,
3417,
3671,
4777,
3157,
3156,
5068,
4314,
3046,
3139,
3151,
4266,
3767,
3160,
3604,
3924,
4306
));
$user_query = new WP_User_Query($param);
$users = $user_query->get_results();
$explist = "";
if (!empty($user_query))
    foreach ($users as $user) {
        if (!pmpro_hasMembershipLevel(array(1,2,3,4,5,6,7,8,9), $user->ID))
            $explist .= $user->ID . ":" . $user->display_name . '<br />';
    }
$param = array(
// 'fields' => 'display_name',
/// 'meta_query' => array( 'key' => 'status', 'value' => 'active', 'meta_compare' => 'LIKE' ),
'include' => array(
4517,
3657,
3248,
4918,
3875,
4985,
4911,
3513,
4826,
3736,
4220,
3135,
4425,
4561,
4672,
4853,
4161,
4583,
4491,
4496,
4781,
3712,
4891,
4906,
4922,
5001,
5002,
4144,
4740,
4744,
4944,
4951,
5045,
5049,
4420,
4806,
4992,
5055,
5027,
2930,
3467,
2930,
3467,
3155,
3401,
4792,
5018,
4931,
4344,
5008,
2990,
4874,
4547,
5041,
5123,
5142,
5115,
5122,
5121,
5172,
5184,
5188,
4982,
4594,
5191,
5192,
3049,
4178,
4625,
4996,
3016,
3145,
5223,
5244,
4462,
3682,
4778,
5264,
5015,
4322,
4697,
4811,
3009,
3800,
4841,
5164,
4296,
5173,
5066,
4606,
5326,
4013,
2925,
5067,
4965,
4809,
5190,
5382,
3851,
3136,
4724,
5111,
5161,
4095,
4942,
5127,
4252,
3331,
3510,
4410,
3106,
4969,
4603,
4884,
4934,
3402,
3103,
5219,
3226,
5035,
2998,
5034,
3630,
5229,
5341,
5510,
4649,
5262,
4976,
5292,
5291,
3244,
4997,
5302,
5442,
3990,
5221,
5551,
5543,
4602,
3144,
3123,
5014,
2970,
5562,
5372,
4779,
3406,
4651,
5147,
3552,
5577,
3941,
5428,
4354,
3071,
3703,
4366,
4147,
3963,
3783,
4176,
4836,
3197,
3184,
5548,
4843,
4049,
5605,
3045,
4361,
4345,
5616,
4818,
3469,
3000,
5626,
5259,
3425,
5573,
5575,
5641,
5149,
4892,
4709,
4802,
2910,
4149,
4733,
5112,
5651,
4770,
5305,
5242,
3969,
3995,
4003,
4738,
4342
));
$remembers = array();
$user_query = new WP_User_Query($param);
$users = $user_query->get_results();
$relist = "";
if (!empty($user_query))
    foreach ($users as $user) {
        if (pmpro_hasMembershipLevel(array(1,2,3,4,5,6,7,8,9), $user->ID))
            $relist .= $user->ID . ":" . $user->display_name . '<br />';
    }
$msg = "";
if (!empty($explist) || !empty($relist)) {
     if (!empty($explist))
         $msg .= '<strong>Expired Members:</strong><br />' . $explist;
     if (!empty($relist))
         $msg .= 'Re-joined Members:<br />' . $relist;
     $headers  = 'MIME-Version: 1.0' . "\r\n";
     $headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";
     $headers .= 'From: it_coordinator@mafw.org' . "\r\n";
     wp_mail("it_coordinator@mafw.org", "Inactive Members in RideWithGPS", $msg, $headers);
}
return $msg;
}
add_shortcode('bk_rwgps_expired', 'bk_rwgps_expired_func');
?>
